<!DOCTYPE html>
<html>
<head>
  <title>Detecting Location</title>
</head>
<body>

<h3>Detecting your locationâ€¦</h3>

<script>
function showError() {
  window.location.href = "/scheme";
}

if (!navigator.geolocation) {
  showError();
} else {
  navigator.geolocation.getCurrentPosition(
    function(pos) {
      fetch("/gps-detect", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          lat: pos.coords.latitude,
          lon: pos.coords.longitude
        })
      })
      .finally(() => {
        window.location.href = "/scheme";
      });
    },
    showError,
    { enableHighAccuracy: true, timeout: 10000 }
  );
}
</script>

</body>
</html>
